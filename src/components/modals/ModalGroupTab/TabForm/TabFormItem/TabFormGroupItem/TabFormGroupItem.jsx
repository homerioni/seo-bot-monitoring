import React, {useEffect, useState} from 'react';
import s from './TabFormGroupItem.module.scss';

const TabFormGroupItem = ({data, register, watch, setItems, searchData}) => {
    const [isCheck, setIsCheck] = useState(watch().groupIds?.includes(String(data.id)));

    const onChange = (e) => {
        setIsCheck(e.target.checked);
        if (e.target.checked) {
            setItems(prev => [...prev, data]);
        } else {
            setItems(prev => prev.filter(item => item.id !== data.id));
        }
    };

    useEffect(() => {
        if (watch().groupIds?.includes(String(data.id))) setItems(prev => [...prev, data]);
    }, []);

    const isShow = data.name.includes(searchData);

    return (
        <div className={`${s.main} ${isCheck ? s.active : ''} ${!isShow ? s.hide : ''}`}>
            <label className={s.checkbox}>
                <input id={`tabGroupLabel${data.id}`} {...register('groupIds')} onInput={onChange} value={data.id} type="checkbox"/>
                <svg width="14" height="11" viewBox="0 0 14 11" fill="none" xmlns="http://www.w3.org/2000/svg">
                    <path d="M13 1.5L4.75 9.75L1 6" stroke="#86E28A" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"/>
                </svg>
            </label>
            <div className={s.qtyServers}>
                <svg width="16" height="14" viewBox="0 0 16 14" fill="none" xmlns="http://www.w3.org/2000/svg">
                    <path fillRule="evenodd" clipRule="evenodd" d="M0.4688 0.455854C-4.76837e-08 0.911632 0 1.6443 0 3.11119C0 4.57808 -4.76837e-08 5.31074 0.4688 5.76652C0.9376 6.2223 1.6912 6.2223 3.2 6.2223H12.8C14.3088 6.2223 15.0624 6.2223 15.5312 5.76652C16 5.31074 16 4.57808 16 3.11119C16 1.6443 16 0.911632 15.5312 0.455854C15.0624 7.62476e-05 14.3088 7.62939e-05 12.8 7.62939e-05H3.2C1.6912 7.62939e-05 0.9376 7.62476e-05 0.4688 0.455854ZM5.6 4.4723C5.44087 4.4723 5.28826 4.41084 5.17574 4.30144C5.06321 4.19205 5 4.04367 5 3.88897V2.33341C5 2.1787 5.06321 2.03033 5.17574 1.92093C5.28826 1.81153 5.44087 1.75008 5.6 1.75008C5.75913 1.75008 5.91174 1.81153 6.02426 1.92093C6.13679 2.03033 6.2 2.1787 6.2 2.33341V3.88897C6.2 4.04367 6.13679 4.19205 6.02426 4.30144C5.91174 4.41084 5.75913 4.4723 5.6 4.4723ZM9.2 2.52785C9.04087 2.52785 8.88826 2.58931 8.77574 2.69871C8.66321 2.8081 8.6 2.95648 8.6 3.11119C8.6 3.2659 8.66321 3.41427 8.77574 3.52367C8.88826 3.63306 9.04087 3.69452 9.2 3.69452H12.8C12.9591 3.69452 13.1117 3.63306 13.2243 3.52367C13.3368 3.41427 13.4 3.2659 13.4 3.11119C13.4 2.95648 13.3368 2.8081 13.2243 2.69871C13.1117 2.58931 12.9591 2.52785 12.8 2.52785H9.2ZM3.2 4.4723C3.04087 4.4723 2.88826 4.41084 2.77574 4.30144C2.66321 4.19205 2.6 4.04367 2.6 3.88897V2.33341C2.6 2.1787 2.66321 2.03033 2.77574 1.92093C2.88826 1.81153 3.04087 1.75008 3.2 1.75008C3.35913 1.75008 3.51174 1.81153 3.62426 1.92093C3.73679 2.03033 3.8 2.1787 3.8 2.33341V3.88897C3.8 4.04367 3.73679 4.19205 3.62426 4.30144C3.51174 4.41084 3.35913 4.4723 3.2 4.4723ZM0.4688 8.23363C-4.76837e-08 8.68941 0 9.42208 0 10.889C0 12.3559 -4.76837e-08 13.0885 0.4688 13.5443C0.9376 14.0001 1.6912 14.0001 3.2 14.0001H12.8C14.3088 14.0001 15.0624 14.0001 15.5312 13.5443C16 13.0885 16 12.3559 16 10.889C16 9.42208 16 8.68941 15.5312 8.23363C15.0624 7.77785 14.3088 7.77785 12.8 7.77785H3.2C1.6912 7.77785 0.9376 7.77785 0.4688 8.23363ZM8.6 10.889C8.6 10.7343 8.66321 10.5859 8.77574 10.4765C8.88826 10.3671 9.04087 10.3056 9.2 10.3056H12.8C12.9591 10.3056 13.1117 10.3671 13.2243 10.4765C13.3368 10.5859 13.4 10.7343 13.4 10.889C13.4 11.0437 13.3368 11.192 13.2243 11.3014C13.1117 11.4108 12.9591 11.4723 12.8 11.4723H9.2C9.04087 11.4723 8.88826 11.4108 8.77574 11.3014C8.66321 11.192 8.6 11.0437 8.6 10.889ZM2.6 11.6667C2.6 11.8215 2.66321 11.9698 2.77574 12.0792C2.88826 12.1886 3.04087 12.2501 3.2 12.2501C3.35913 12.2501 3.51174 12.1886 3.62426 12.0792C3.73679 11.9698 3.8 11.8215 3.8 11.6667V10.1112C3.8 9.95648 3.73679 9.80811 3.62426 9.69871C3.51174 9.58931 3.35913 9.52785 3.2 9.52785C3.04087 9.52785 2.88826 9.58931 2.77574 9.69871C2.66321 9.80811 2.6 9.95648 2.6 10.1112V11.6667ZM5.6 12.2501C5.44087 12.2501 5.28826 12.1886 5.17574 12.0792C5.06321 11.9698 5 11.8215 5 11.6667V10.1112C5 9.95648 5.06321 9.80811 5.17574 9.69871C5.28826 9.58931 5.44087 9.52785 5.6 9.52785C5.75913 9.52785 5.91174 9.58931 6.02426 9.69871C6.13679 9.80811 6.2 9.95648 6.2 10.1112V11.6667C6.2 11.8215 6.13679 11.9698 6.02426 12.0792C5.91174 12.1886 5.75913 12.2501 5.6 12.2501Z" fill="#5BC2FF"/>
                </svg>
                <span>{data.servers.length}</span>
            </div>
            <p className={s.name}>{data.name}</p>
        </div>
    );
};

export default TabFormGroupItem;